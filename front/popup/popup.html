<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>ChatGPT Carbon</title>
  <style>
    body {
      margin: 0;
      min-width: 320px;
      background: #f5f5f7;
      font: 13px/1.45 "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color: #1f1f24;
    }

    main {
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    h1 {
      font-size: 17px;
      margin: 0 0 4px;
    }

    p {
      margin: 0;
    }

    .card {
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(31, 31, 36, 0.08);
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .header {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .subtitle {
      color: #5f5f6e;
      font-size: 12px;
    }

    .hidden {
      display: none !important;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .field label {
      font-weight: 600;
      font-size: 12px;
      color: #4a4a55;
    }

    .field input {
      border-radius: 8px;
      border: 1px solid #d2d2d7;
      padding: 6px 8px;
      font: inherit;
      color: inherit;
      background: #fbfbfd;
    }

    .field input:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.15);
      background: #ffffff;
    }

    button {
      border-radius: 999px;
      padding: 7px 14px;
      font: inherit;
      cursor: pointer;
      border: none;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.2s ease;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .primary {
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      color: #ffffff;
      font-weight: 600;
      text-align: center;
      box-shadow: 0 6px 16px rgba(99, 102, 241, 0.25);
    }

    .primary:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(99, 102, 241, 0.3);
    }

    .ghost {
      background: transparent;
      color: #4f46e5;
      font-weight: 600;
    }

    .ghost:hover:not(:disabled) {
      background: rgba(79, 70, 229, 0.08);
    }

    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .user-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .user-label {
      font-size: 11px;
      color: #6b7280;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .user-email {
      font-weight: 600;
    }

    .message {
      min-height: 18px;
      font-size: 12px;
      color: #4a4a55;
    }

    .message.error {
      color: #d12c4f;
    }

    .message.success {
      color: #0f9d58;
    }

    .estimation {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .estimation-row {
      display: flex;
      justify-content: space-between;
      gap: 12px;
    }

    .estimation-row strong {
      font-size: 13px;
    }

    .empty-state {
      color: #6b7280;
      font-style: italic;
    }

    .server-hint {
      font-size: 11px;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <main>
    <header class="header">
      <h1>ChatGPT Carbon</h1>
      <p class="subtitle">Suivez vos émissions et gérez votre session.</p>
    </header>

    <section id="authSection" class="card">
      <div class="message" id="authMessage"></div>
      <div class="field">
        <label for="authEmail">Adresse e-mail</label>
        <input type="email" id="authEmail" autocomplete="email" spellcheck="false" required>
      </div>
      <div class="field">
        <label for="authPassword">Mot de passe</label>
        <input type="password" id="authPassword" autocomplete="current-password" required>
      </div>
      <div class="field hidden" id="authPasswordConfirmRow">
        <label for="authPasswordConfirm">Confirmer le mot de passe</label>
        <input type="password" id="authPasswordConfirm" autocomplete="new-password">
      </div>
      <button id="authSubmit" class="primary">Se connecter</button>
      <button id="toggleAuthMode" class="ghost" type="button">Créer un compte</button>
    </section>

    <section id="dashboardSection" class="card hidden">
      <div class="top-row">
        <div class="user-block">
          <span class="user-label">Connecté</span>
          <span class="user-email" id="currentUserEmail"></span>
          <span class="server-hint">Serveur : <span id="serverUrl"></span></span>
        </div>
        <button id="logoutButton" class="ghost" type="button">Se déconnecter</button>
      </div>
      <div class="message" id="dashboardMessage"></div>
      <div id="estimation" class="estimation">
        <p class="empty-state">Aucune estimation récente.</p>
      </div>
    </section>
  </main>

  <script type="module" src="popup.js"></script>
</body>
</html>
